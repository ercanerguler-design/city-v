<!DOCTYPE html><!DOCTYPE html>

<html lang="tr"><html lang="tr">

<head><head>

    <meta charset="UTF-8">    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>ESP32-CAM Stream Test</title>    <title>ESP32-CAM Stream Test</title>

    <style>    <style>

        * { margin: 0; padding: 0; box-sizing: border-box; }        * {

        body {            margin: 0;

            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;            padding: 0;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);            box-sizing: border-box;

            min-height: 100vh;        }

            padding: 20px;        body {

        }            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

        .container { max-width: 1200px; margin: 0 auto; }            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

        h1 {            min-height: 100vh;

            color: white;            padding: 20px;

            text-align: center;            color: white;

            margin-bottom: 30px;        }

            font-size: 2.5em;        .container {

            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);            max-width: 1200px;

        }            margin: 0 auto;

        .controls {        }

            background: white;        h1 {

            padding: 20px;            text-align: center;

            border-radius: 15px;            margin-bottom: 30px;

            margin-bottom: 20px;            font-size: 2.5rem;

            box-shadow: 0 10px 30px rgba(0,0,0,0.2);            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);

        }        }

        .input-group { margin-bottom: 15px; }        .control-panel {

        label {            background: rgba(255,255,255,0.1);

            display: block;            backdrop-filter: blur(10px);

            font-weight: 600;            border-radius: 15px;

            margin-bottom: 8px;            padding: 20px;

            color: #333;            margin-bottom: 20px;

        }        }

        input {        .input-group {

            width: 100%;            display: flex;

            padding: 12px;            gap: 10px;

            border: 2px solid #ddd;            margin-bottom: 15px;

            border-radius: 8px;        }

            font-size: 16px;        input {

            transition: border-color 0.3s;            flex: 1;

        }            padding: 15px;

        input:focus { outline: none; border-color: #667eea; }            font-size: 16px;

        .btn-group { display: flex; gap: 10px; margin-top: 20px; }            border: 2px solid rgba(255,255,255,0.3);

        button {            border-radius: 10px;

            flex: 1;            background: rgba(255,255,255,0.9);

            padding: 15px;            font-family: 'Courier New', monospace;

            border: none;        }

            border-radius: 8px;        button {

            font-size: 16px;            padding: 15px 30px;

            font-weight: 600;            font-size: 16px;

            cursor: pointer;            font-weight: bold;

            transition: all 0.3s;            border: none;

        }            border-radius: 10px;

        .btn-start {            cursor: pointer;

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);            transition: all 0.3s ease;

            color: white;            text-transform: uppercase;

        }        }

        .btn-start:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }        .btn-test {

        .btn-stop { background: #ef4444; color: white; }            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

        .btn-stop:hover { background: #dc2626; }            color: white;

        .stream-grid {        }

            display: grid;        .btn-start {

            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);

            gap: 20px;            color: white;

            margin-top: 20px;        }

        }        .btn-stop {

        .stream-card {            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);

            background: white;            color: white;

            border-radius: 15px;        }

            overflow: hidden;        button:hover {

            box-shadow: 0 10px 30px rgba(0,0,0,0.2);            transform: translateY(-2px);

        }            box-shadow: 0 5px 15px rgba(0,0,0,0.3);

        .stream-header {        }

            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);        button:disabled {

            color: white;            opacity: 0.5;

            padding: 15px;            cursor: not-allowed;

            display: flex;            transform: none;

            justify-content: space-between;        }

            align-items: center;        .status {

        }            padding: 10px;

        .stream-body {            border-radius: 10px;

            position: relative;            margin-bottom: 10px;

            background: #000;            font-weight: bold;

            aspect-ratio: 4/3;            text-align: center;

        }        }

        .stream-body img {        .status.success {

            width: 100%;            background: rgba(56, 239, 125, 0.3);

            height: 100%;            border: 2px solid #38ef7d;

            object-fit: contain;        }

        }        .status.error {

        .status {            background: rgba(235, 51, 73, 0.3);

            display: inline-flex;            border: 2px solid #eb3349;

            align-items: center;        }

            gap: 5px;        .status.info {

            padding: 5px 12px;            background: rgba(102, 126, 234, 0.3);

            border-radius: 20px;            border: 2px solid #667eea;

            font-size: 14px;        }

            font-weight: 600;        .stream-container {

        }            background: black;

        .status.online { background: #10b981; }            border-radius: 15px;

        .status.offline { background: #ef4444; }            overflow: hidden;

        .pulse {            position: relative;

            width: 8px;            box-shadow: 0 10px 30px rgba(0,0,0,0.5);

            height: 8px;        }

            background: white;        .stream-container img {

            border-radius: 50%;            width: 100%;

            animation: pulse 2s infinite;            height: auto;

        }            display: block;

        @keyframes pulse {        }

            0%, 100% { opacity: 1; }        .live-badge {

            50% { opacity: 0.3; }            position: absolute;

        }            top: 20px;

        .info { background: #f3f4f6; padding: 15px; }            left: 20px;

        .info-item {            background: rgba(235, 51, 73, 0.9);

            display: flex;            padding: 8px 16px;

            justify-content: space-between;            border-radius: 20px;

            margin-bottom: 8px;            font-weight: bold;

            font-size: 14px;            display: flex;

        }            align-items: center;

        .info-label { color: #6b7280; font-weight: 600; }            gap: 8px;

        .info-value { color: #1f2937; font-weight: 700; }        }

    </style>        .pulse {

</head>            width: 10px;

<body>            height: 10px;

    <div class="container">            background: white;

        <h1>üé• ESP32-CAM Stream Test</h1>            border-radius: 50%;

                    animation: pulse 1s infinite;

        <div class="controls">        }

            <h2 style="margin-bottom: 20px; color: #333;">Kamera IP Ayarlarƒ±</h2>        @keyframes pulse {

            <div class="input-group">            0%, 100% { opacity: 1; }

                <label for="ip1">üìπ Kamera 1 IP:</label>            50% { opacity: 0.3; }

                <input type="text" id="ip1" value="192.168.1.9" placeholder="192.168.1.9">        }

            </div>        .log {

            <div class="input-group">            background: rgba(0,0,0,0.5);

                <label for="ip2">üìπ Kamera 2 IP:</label>            border-radius: 10px;

                <input type="text" id="ip2" value="192.168.1.10" placeholder="192.168.1.10">            padding: 15px;

            </div>            margin-top: 20px;

            <div class="input-group">            font-family: 'Courier New', monospace;

                <label for="ip3">üìπ Kamera 3 IP:</label>            font-size: 12px;

                <input type="text" id="ip3" value="192.168.1.11" placeholder="192.168.1.11">            max-height: 300px;

            </div>            overflow-y: auto;

            <div class="input-group">        }

                <label for="ip4">üìπ Kamera 4 IP:</label>        .log-entry {

                <input type="text" id="ip4" value="192.168.1.12" placeholder="192.168.1.12">            padding: 5px 0;

            </div>            border-bottom: 1px solid rgba(255,255,255,0.1);

            <div class="btn-group">        }

                <button class="btn-start" onclick="startStreams()">‚ñ∂Ô∏è Ba≈ülat</button>        .url-test {

                <button class="btn-stop" onclick="stopStreams()">‚èπÔ∏è Durdur</button>            margin-top: 15px;

            </div>            padding: 15px;

        </div>            background: rgba(0,0,0,0.3);

            border-radius: 10px;

        <div class="stream-grid" id="streamGrid"></div>        }

    </div>        .url-test h3 {

            margin-bottom: 10px;

    <script>        }

        let cameras = [];        .url-list {

            display: flex;

        function startStreams() {            flex-direction: column;

            const ips = [            gap: 5px;

                document.getElementById('ip1').value,        }

                document.getElementById('ip2').value,        .url-item {

                document.getElementById('ip3').value,            padding: 10px;

                document.getElementById('ip4').value            background: rgba(255,255,255,0.1);

            ];            border-radius: 5px;

            font-family: 'Courier New', monospace;

            cameras = ips.map((ip, index) => ({            font-size: 14px;

                id: `ESP32-${String(index + 1).padStart(3, '0')}`,            cursor: pointer;

                name: `Kamera ${index + 1}`,            transition: background 0.2s;

                ip: ip,        }

                streamUrl: `http://${ip}/stream`,        .url-item:hover {

                status: 'offline',            background: rgba(255,255,255,0.2);

                startTime: new Date()        }

            }));    </style>

</head>

            renderStreams();<body>

                <div class="container">

            cameras.forEach((camera, index) => {        <h1>üé• ESP32-CAM Stream Test</h1>

                const img = document.getElementById(`stream-${index}`);        

                if (img) {        <div class="control-panel">

                    img.src = camera.streamUrl;            <div class="input-group">

                    img.onerror = () => updateStatus(index, 'offline');                <input type="text" id="deviceIp" placeholder="ESP32 IP Adresi (√∂rn: 192.168.1.9)" value="192.168.1.9">

                    img.onload = () => updateStatus(index, 'online');                <button class="btn-test" onclick="testConnection()">üîç Test Baƒülantƒ±</button>

                }                <button class="btn-start" onclick="startStream()">‚ñ∂Ô∏è Ba≈ülat</button>

            });                <button class="btn-stop" onclick="stopStream()">‚èπÔ∏è Durdur</button>

        }            </div>

            

        function stopStreams() {            <div id="status"></div>

            cameras.forEach((camera, index) => {            

                const img = document.getElementById(`stream-${index}`);            <div class="url-test">

                if (img) {                <h3>üì° Denenmesi Gereken URL'ler:</h3>

                    img.src = '';                <div class="url-list" id="urlList"></div>

                    updateStatus(index, 'offline');            </div>

                }        </div>

            });        

        }        <div class="stream-container" id="streamContainer">

            <img id="streamImage" style="display: none;">

        function updateStatus(index, status) {            <div style="padding: 100px; text-align: center; color: #666;">

            const statusEl = document.getElementById(`status-${index}`);                <h2>Kamera stream'i ba≈ülatƒ±lmadƒ±</h2>

            if (statusEl) {                <p>Yukarƒ±dan IP adresini girin ve "Ba≈ülat" butonuna tƒ±klayƒ±n</p>

                statusEl.className = `status ${status}`;            </div>

                statusEl.innerHTML = status === 'online'         </div>

                    ? '<span class="pulse"></span> CANLI'         

                    : '<span class="pulse"></span> OFFLINE';        <div class="log" id="log"></div>

            }    </div>



            const urlEl = document.getElementById(`url-${index}`);    <script>

            if (urlEl && status === 'offline') {        let streamImg = document.getElementById('streamImage');

                urlEl.innerHTML = `<strong>‚ö†Ô∏è BAƒûLANTI HATASI</strong><br>        let statusDiv = document.getElementById('status');

                    ‚Ä¢ ESP32 a√ßƒ±k deƒüil<br>        let logDiv = document.getElementById('log');

                    ‚Ä¢ IP adresi yanlƒ±≈ü<br>        let urlListDiv = document.getElementById('urlList');

                    ‚Ä¢ WiFi network'te deƒüil`;

            }        function addLog(message, type = 'info') {

        }            const timestamp = new Date().toLocaleTimeString();

            const emoji = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : 'üìã';

        function renderStreams() {            const entry = document.createElement('div');

            const grid = document.getElementById('streamGrid');            entry.className = 'log-entry';

            grid.innerHTML = cameras.map((camera, index) => `            entry.textContent = `[${timestamp}] ${emoji} ${message}`;

                <div class="stream-card">            logDiv.insertBefore(entry, logDiv.firstChild);

                    <div class="stream-header">        }

                        <div>

                            <div style="font-size: 18px; font-weight: 700;">${camera.name}</div>        function setStatus(message, type) {

                            <div style="font-size: 12px; opacity: 0.9;">${camera.id}</div>            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;

                        </div>        }

                        <div id="status-${index}" class="status offline">

                            <span class="pulse"></span> OFFLINE        function getStreamUrls(ip) {

                        </div>            return [

                    </div>                `http://${ip}/stream`,

                    <div class="stream-body">                `http://${ip}:81/stream`,

                        <img id="stream-${index}" alt="${camera.name}">                `http://${ip}/cam`,

                    </div>                `http://${ip}:81/cam`,

                    <div class="info">                `http://${ip}/video`,

                        <div class="info-item">                `http://${ip}:8080/stream`,

                            <span class="info-label">IP:</span>            ];

                            <span class="info-value">${camera.ip}</span>        }

                        </div>

                        <div class="info-item">        function updateUrlList() {

                            <span class="info-label">URL:</span>            const ip = document.getElementById('deviceIp').value;

                            <span class="info-value" id="url-${index}" style="font-size: 11px; word-break: break-all;">${camera.streamUrl}</span>            const urls = getStreamUrls(ip);

                        </div>            urlListDiv.innerHTML = '';

                        <div class="info-item">            

                            <span class="info-label">Zaman:</span>            urls.forEach((url, index) => {

                            <span class="info-value">${camera.startTime.toLocaleTimeString('tr-TR')}</span>                const item = document.createElement('div');

                        </div>                item.className = 'url-item';

                    </div>                item.textContent = `${index + 1}. ${url}`;

                </div>                item.onclick = () => {

            `).join('');                    document.getElementById('deviceIp').value = ip;

        }                    streamImg.src = url;

                    addLog(`Manuel URL deneniyor: ${url}`, 'info');

        window.onload = () => startStreams();                };

    </script>                urlListDiv.appendChild(item);

</body>            });

</html>        }


        async function testConnection() {
            const ip = document.getElementById('deviceIp').value;
            if (!ip) {
                alert('L√ºtfen IP adresi girin!');
                return;
            }

            setStatus('üîç Baƒülantƒ± test ediliyor...', 'info');
            addLog(`Baƒülantƒ± testi ba≈ülatƒ±ldƒ±: ${ip}`, 'info');
            updateUrlList();

            const urls = getStreamUrls(ip);
            
            for (let i = 0; i < urls.length; i++) {
                const url = urls[i];
                try {
                    addLog(`Test ediliyor [${i+1}/${urls.length}]: ${url}`, 'info');
                    
                    const response = await fetch(url, { 
                        method: 'HEAD',
                        mode: 'no-cors',
                        signal: AbortSignal.timeout(3000)
                    });
                    
                    addLog(`‚úÖ BA≈ûARILI! ${url} √ßalƒ±≈üƒ±yor!`, 'success');
                    setStatus(`‚úÖ BAƒûLANTI BA≈ûARILI: ${url}`, 'success');
                    return;
                } catch (error) {
                    addLog(`‚ùå Ba≈üarƒ±sƒ±z: ${url} - ${error.message}`, 'error');
                }
            }
            
            setStatus('‚ùå Hi√ßbir URL √ßalƒ±≈ümƒ±yor! ESP32 a√ßƒ±k mƒ± kontrol edin.', 'error');
        }

        function startStream() {
            const ip = document.getElementById('deviceIp').value;
            if (!ip) {
                alert('L√ºtfen IP adresi girin!');
                return;
            }

            const streamUrl = `http://${ip}/stream`;
            addLog(`Stream ba≈ülatƒ±lƒ±yor: ${streamUrl}`, 'info');
            setStatus('üé¨ Stream ba≈ülatƒ±lƒ±yor...', 'info');

            streamImg.style.display = 'block';
            streamImg.src = streamUrl;

            streamImg.onload = () => {
                addLog(`‚úÖ STREAM BA≈ûARILI! Boyut: ${streamImg.naturalWidth}x${streamImg.naturalHeight}`, 'success');
                setStatus(`‚úÖ CANLI YAYIN AKTIF: ${streamUrl}`, 'success');
                
                // Live badge ekle
                let badge = document.getElementById('liveBadge');
                if (!badge) {
                    badge = document.createElement('div');
                    badge.id = 'liveBadge';
                    badge.className = 'live-badge';
                    badge.innerHTML = '<div class="pulse"></div> LIVE';
                    document.getElementById('streamContainer').appendChild(badge);
                }
            };

            streamImg.onerror = () => {
                addLog(`‚ùå STREAM HATASI: ${streamUrl} baƒülantƒ± kurulamadƒ±!`, 'error');
                setStatus(`‚ùå STREAM HATASI: Baƒülantƒ± kurulamadƒ±!`, 'error');
                streamImg.style.display = 'none';
                
                // Otomatik olarak diƒüer URL'leri dene
                addLog('üîÑ Alternatif URL\'ler deneniyor...', 'info');
                const urls = getStreamUrls(ip);
                tryNextUrl(urls, 1); // ƒ∞lkini zaten denedik, 2.den ba≈üla
            };
        }

        function tryNextUrl(urls, index) {
            if (index >= urls.length) {
                addLog('‚ùå T√ºm URL\'ler denendi, hi√ßbiri √ßalƒ±≈ümadƒ±!', 'error');
                return;
            }

            const url = urls[index];
            addLog(`Deneniyor [${index+1}/${urls.length}]: ${url}`, 'info');
            
            streamImg.src = url;
            
            streamImg.onload = () => {
                addLog(`‚úÖ BA≈ûARILI! ${url} √ßalƒ±≈üƒ±yor!`, 'success');
                setStatus(`‚úÖ CANLI YAYIN: ${url}`, 'success');
            };
            
            streamImg.onerror = () => {
                addLog(`‚ùå Ba≈üarƒ±sƒ±z: ${url}`, 'error');
                setTimeout(() => tryNextUrl(urls, index + 1), 1000);
            };
        }

        function stopStream() {
            streamImg.src = '';
            streamImg.style.display = 'none';
            
            const badge = document.getElementById('liveBadge');
            if (badge) badge.remove();
            
            setStatus('‚èπÔ∏è Stream durduruldu', 'info');
            addLog('Stream kapatƒ±ldƒ±', 'info');
        }

        // Sayfa y√ºklendiƒüinde URL listesini g√∂ster
        updateUrlList();
        addLog('ESP32-CAM Stream Test hazƒ±r', 'success');
    </script>
</body>
</html>
